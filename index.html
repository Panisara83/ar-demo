<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>AR Debug Page</title>
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@ar-js-org/ar.js@3.4.3/aframe/build/aframe-ar.js"></script>
  <style>
    body { font-family: monospace; background: #111; color: #0f0; padding: 10px; }
    #log { white-space: pre-wrap; background: #222; padding: 10px; border-radius: 8px; }
    button { margin: 10px 0; padding: 5px 15px; }
  </style>
</head>
<body>
  <h2>üîç AR Debug Console</h2>
  <button onclick="checkPermissions()">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏•‡πâ‡∏≠‡∏á</button>
  <button onclick="startCamera()">‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á</button>
  <button onclick="stopCamera()">‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á</button>
  
  <div id="log">[Log ‡∏à‡∏∞‡∏°‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ]</div>

  <script>
    const logBox = document.getElementById("log");
    function log(msg) {
      console.log(msg);
      logBox.textContent += `\n${msg}`;
    }

    // ‚úÖ Step 1: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö HTTPS
    if (location.protocol !== "https:") {
      log("‚ùå ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ HTTPS (‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠ " + location.protocol + ")");
    } else {
      log("‚úÖ HTTPS ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô");
    }

    // ‚úÖ Step 2: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö WebXR
    if (navigator.xr) {
      log("‚úÖ WebXR ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÉ‡∏ô Browser ‡∏ô‡∏µ‡πâ");
    } else {
      log("‚ùå Browser ‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö WebXR");
    }

    // ‚úÖ Step 3: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏•‡πâ‡∏≠‡∏á
    async function checkPermissions() {
      try {
        const status = await navigator.permissions.query({ name: "camera" });
        log("üì∑ Camera permission state: " + status.state);
      } catch (e) {
        log("‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏•‡πâ‡∏≠‡∏á: " + e);
      }
    }

    // ‚úÖ Step 4: ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á
    let stream;
    async function startCamera() {
      try {
        stream = await navigator.mediaDevices.getUserMedia({ video: true });
        log("‚úÖ ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
      } catch (e) {
        log("‚ùå ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: " + e.message);
      }
    }

    // ‚úÖ Step 5: ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á
    function stopCamera() {
      if (stream) {
        stream.getTracks().forEach(track => track.stop());
        log("üõë ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏ñ‡∏π‡∏Å‡∏õ‡∏¥‡∏î‡πÅ‡∏•‡πâ‡∏ß");
      } else {
        log("‚ö†Ô∏è ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà");
      }
    }
  </script>
</body>
</html>
